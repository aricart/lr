{"id":"lr-1fr","title":"ANTHROPIC_API_KEY not required for review start","description":"lr review start only needs ollama for indexing but currently the OllamaClaudeClient requires ANTHROPIC_API_KEY. Review session indexing should work without any API keys since it only uses local ollama embeddings.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-15T22:35:20.633224-06:00","updated_at":"2025-12-15T22:37:15.633703-06:00","closed_at":"2025-12-15T22:37:15.633703-06:00","close_reason":"fixed README - lr review uses local ollama only, no API keys needed"}
{"id":"lr-1j7","title":"get_diff_context MCP tool","description":"MCP tool that returns git diff + relevant indexed context from review index. Enables Claude to review with full codebase knowledge.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T21:44:33.404354-06:00","updated_at":"2025-12-15T22:02:24.841328-06:00","closed_at":"2025-12-15T22:02:24.841328-06:00","close_reason":"Closed","dependencies":[{"issue_id":"lr-1j7","depends_on_id":"lr-lz8","type":"blocks","created_at":"2025-12-15T21:45:42.427495-06:00","created_by":"daemon"}]}
{"id":"lr-4l4","title":"improve semantic query in get_diff_context","description":"mcp.go:511 - 'code related to %s' query is weak. Use actual diff content, function names, or file content for better semantic matches","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-15T22:15:52.355837-06:00","updated_at":"2025-12-15T22:27:55.398399-06:00","closed_at":"2025-12-15T22:27:55.398399-06:00","close_reason":"fixed in code review cleanup"}
{"id":"lr-4oi","title":"detect document type from extension in watch mode","description":"review.go:441-444 - hardcodes type='code'. Should detect .md files as 'markdown' vs other files as 'code'","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-15T22:16:14.099453-06:00","updated_at":"2025-12-15T22:16:14.099453-06:00"}
{"id":"lr-4wo","title":"add ollama chat support for fully local querying","description":"Add chat support to OllamaClient using /api/chat endpoint. This enables completely offline querying with models like llama3, codellama, etc. No API keys needed for either embedding or chat.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-15T22:40:52.337482-06:00","updated_at":"2025-12-15T22:40:52.337482-06:00"}
{"id":"lr-5zh","title":"read embedding model from session/index metadata","description":"mcp.go:484 - hardcodes 'nomic-embed-text'. Should read from store.Metadata.EmbeddingModel or session to ensure query embeddings match index embeddings","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T22:15:57.42216-06:00","updated_at":"2025-12-15T22:27:55.402337-06:00","closed_at":"2025-12-15T22:27:55.402337-06:00","close_reason":"fixed in code review cleanup","dependencies":[{"issue_id":"lr-5zh","depends_on_id":"lr-4l4","type":"blocks","created_at":"2025-12-15T22:16:42.46587-06:00","created_by":"daemon"}]}
{"id":"lr-74f","title":"batch embedding support for faster review indexing","description":"","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-15T22:21:21.017408-06:00","updated_at":"2025-12-16T00:10:21.899353-06:00","closed_at":"2025-12-16T00:10:21.899353-06:00","close_reason":"Closed"}
{"id":"lr-76z","title":"get_diff_context should work without review session","description":"","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-16T00:23:44.560302-06:00","updated_at":"2025-12-16T00:23:44.560302-06:00"}
{"id":"lr-77n","title":"Add ollama embedding provider","description":"Add ollama as embedding provider. Uses local nomic-embed-text or mxbai-embed-large model. No API key needed.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T21:44:10.395474-06:00","updated_at":"2025-12-15T22:00:33.772021-06:00","closed_at":"2025-12-15T22:00:33.772021-06:00","close_reason":"Closed"}
{"id":"lr-7hf","title":"Implement incremental index updates - only re-index changed files","description":"## Overview\nAdd incremental indexing to lr so only changed files are re-indexed, saving time and API costs.\n\n## Approach: Dual change detection\nSupport both mtime-based (default) and git-based detection.\n\n### mtime-based (default)\n- Compare file.ModTime() vs IndexedAt timestamp\n- Works on any directory, no git required\n- Simple and fast\n\n### git-based (--git flag)\n- Use git diff \u003clast-commit\u003e..HEAD --name-only\n- More accurate for git repos\n- Handles renames/moves properly\n- Requires LastCommit stored in metadata\n\n## Implementation Plan\n\n### 1. Add tracking fields to metadata\n- LastCommit string - git commit hash (for git mode)\n- IndexedAt already exists (for mtime mode)\n\n### 2. Add flags to index command\n- --update: enable incremental update\n- --git: use git-based detection (default: mtime)\n\n### 3. Implement change detection\nmtime mode:\n- Parse IndexedAt from existing index\n- Scan files, collect where mtime \u003e IndexedAt\n\ngit mode:\n- Get LastCommit from existing index\n- Run git diff to find changed files\n\n### 4. Implement incremental update logic\n- Remove chunks from deleted/modified files\n- Load and chunk only changed files\n- Generate embeddings for new chunks\n- Merge with existing chunks\n\n### 5. Safe index upgrade (atomic)\n- Write to temp file first\n- Validate temp file loads correctly\n- Replace original only after validation\n- Original preserved on failure\n\n### 6. Files to modify\n- vectorstore.go: Add LastCommit, RemoveBySource()\n- main.go: Add --update/--git flags, implement logic\n\n## Benefits\n- 10-100x faster for small changes\n- Works with or without git\n- Safe atomic updates","notes":"Added legacy index migration: extracts IndexedFiles from chunk.Source when metadata is empty. Tested successfully.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T18:51:45.884022-06:00","updated_at":"2025-12-15T19:17:47.893312-06:00","closed_at":"2025-12-15T19:08:16.559727-06:00"}
{"id":"lr-9g7","title":"missing ANTHROPIC_API_KEY validation in OllamaClaudeClient","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-15T22:21:19.655024-06:00","updated_at":"2025-12-15T22:27:55.39963-06:00","closed_at":"2025-12-15T22:27:55.39963-06:00","close_reason":"fixed in code review cleanup"}
{"id":"lr-aib","title":"add timeout to Ollama HTTP client","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-15T22:21:20.677075-06:00","updated_at":"2025-12-15T22:27:55.40153-06:00","closed_at":"2025-12-15T22:27:55.40153-06:00","close_reason":"fixed in code review cleanup"}
{"id":"lr-be0","title":"stale session file blocks new review sessions","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-15T22:21:19.988639-06:00","updated_at":"2025-12-15T22:27:55.400117-06:00","closed_at":"2025-12-15T22:27:55.400117-06:00","close_reason":"fixed in code review cleanup"}
{"id":"lr-ca4","title":"extractChangedFiles returns non-deterministic order","description":"","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-15T22:21:21.728464-06:00","updated_at":"2025-12-15T22:27:55.401945-06:00","closed_at":"2025-12-15T22:27:55.401945-06:00","close_reason":"fixed in code review cleanup"}
{"id":"lr-cx3","title":"allow lr index with ollama embeddings without API keys","description":"Indexing only needs embeddings, not chat. When using --embedding-model=ollama, skip chat client creation and allow indexing with just local ollama.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-15T22:40:52.01695-06:00","updated_at":"2025-12-15T22:44:35.731018-06:00","closed_at":"2025-12-15T22:44:35.731018-06:00","close_reason":"implemented lazy Claude client - indexing with ollama works without ANTHROPIC_API_KEY"}
{"id":"lr-cze","title":"warn early if ANTHROPIC_API_KEY missing for OllamaClaudeClient","description":"ollama.go:97 - if claudeKey is empty, chat will fail later with confusing error. Should warn at client creation time","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-15T22:16:07.923279-06:00","updated_at":"2025-12-15T22:27:55.402746-06:00","closed_at":"2025-12-15T22:27:55.402746-06:00","close_reason":"fixed in code review cleanup"}
{"id":"lr-dqr","title":"add sources filter to query_repositories MCP tool","description":"The CLI has --sources flag to filter which indexes to search, but the MCP query_repositories tool searches all indexes. Add a sources parameter to filter results to specific indexes.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-15T22:49:25.383969-06:00","updated_at":"2025-12-15T22:51:35.949457-06:00","closed_at":"2025-12-15T22:51:35.949457-06:00","close_reason":"added sources parameter to query_repositories MCP tool"}
{"id":"lr-fei","title":"extract shared skip directories constant","description":"review.go:372-373 duplicates skip list from loader.go. Extract to shared constant to avoid drift","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-15T22:16:19.022934-06:00","updated_at":"2025-12-15T22:16:19.022934-06:00"}
{"id":"lr-j4h","title":"hardcoded embedding model in MCP get_diff_context handler","description":"","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-15T22:21:19.319849-06:00","updated_at":"2025-12-15T22:27:55.399091-06:00","closed_at":"2025-12-15T22:27:55.399091-06:00","close_reason":"fixed in code review cleanup"}
{"id":"lr-jqy","title":"add hybrid keyword+semantic search for code","description":"Pure semantic search with general-purpose embeddings (nomic-embed-text) fails to find code by function/type names. Need to combine keyword search (grep-like) with semantic search for better code discovery.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-15T22:59:29.32941-06:00","updated_at":"2025-12-15T22:59:29.32941-06:00"}
{"id":"lr-k1r","title":"update README with get_diff_context usage examples","description":"Add more detailed examples showing how to use get_diff_context with Claude Code for code review workflows","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-15T22:35:20.280196-06:00","updated_at":"2025-12-15T22:35:20.280196-06:00"}
{"id":"lr-k8e","title":"handleGetDiffContext ignores context for cancellation","description":"","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-15T22:21:20.332471-06:00","updated_at":"2025-12-15T22:27:55.400611-06:00","closed_at":"2025-12-15T22:27:55.400611-06:00","close_reason":"fixed in code review cleanup"}
{"id":"lr-kmj","title":"add branch diff option to get_diff_context","description":"Currently only shows uncommitted changes (git diff + git diff --cached). Add option to include all commits in current branch vs main (git diff main...HEAD)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T22:16:02.842596-06:00","updated_at":"2025-12-15T23:51:30.727321-06:00","closed_at":"2025-12-15T23:51:30.727321-06:00","close_reason":"implemented: branch diff is now default, uncommitted_only flag for old behavior","dependencies":[{"issue_id":"lr-kmj","depends_on_id":"lr-4l4","type":"blocks","created_at":"2025-12-15T22:16:37.406669-06:00","created_by":"daemon"}]}
{"id":"lr-lz8","title":"Session-based review index","description":"Temporary index for code review. Created with 'lr review start', deleted with 'lr review stop'. Stored separately from permanent indexes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T21:44:23.408833-06:00","updated_at":"2025-12-15T21:54:21.009749-06:00","closed_at":"2025-12-15T21:54:21.009749-06:00","close_reason":"Closed","dependencies":[{"issue_id":"lr-lz8","depends_on_id":"lr-77n","type":"blocks","created_at":"2025-12-15T21:45:38.637904-06:00","created_by":"daemon"}]}
{"id":"lr-nyl","title":"test branch diff behavior after MCP reconnect","description":"","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-16T00:04:16.590013-06:00","updated_at":"2025-12-16T00:24:14.762532-06:00","closed_at":"2025-12-16T00:24:14.762532-06:00","close_reason":"tested - MCP reconnect works fine. found improvement: get_diff_context should use cwd instead of requiring review session. created lr-76z for that."}
{"id":"lr-oek","title":"add diff display theme/color configuration","description":"User wants option to configure less garish diff output. Options discussed: terminal theme, NO_COLOR=1, git config colors, or stripping ANSI from lr mcp tool output","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-15T22:35:19.926738-06:00","updated_at":"2025-12-15T22:35:19.926738-06:00"}
{"id":"lr-olk","title":"enhancements","description":"To make your MCP server more useful to Claude, focus on enhancing its functionality, clarity, and integration with Claude's capabilities. Start by ensuring your server is built using the Model Context Protocol (MCP), which standardizes how Claude interacts with external tools through JSON Schema definitions that specify inputs and outputs.\n This allows Claude to understand what the tool does, what data it needs, and what it returns.\n\nDesign your server to provide specific, well-documented tools rather than generic ones. For example, instead of a single \"getInfo\" tool, use descriptive names like \"users_getById\" or \"products_searchByCategory\" to help Claude select the right tool based on context.\n This improves usability and reduces errors in tool selection.\n\nIntegrate real-time data access to make the server more dynamic. For instance, if your server queries a database or API, ensure it can return up-to-date information, which transforms Claude from a static conversational AI into a practical assistant capable of performing real-world tasks.\n Tools like Context7, which fetches real-time documentation from source repositories, exemplify this value.\n\nOptimize for performance and scalability, especially if your server handles large APIs. Implement pagination in tool schemas using parameters like limit and offset to prevent excessive data retrieval and avoid timeouts or rate limiting.\n Group related endpoints under consistent naming patterns to improve organization and navigation.\n\nEnhance user experience by enabling secure, permission-based access. When Claude attempts to use a tool, it should prompt for approval, especially for actions that execute code or access system resources.\n This builds trust and safety while maintaining functionality.\n\nFinally, consider using a centralized management approach. Tools like the Docker MCP Toolkit allow you to manage multiple MCP servers from Docker Desktop, automatically exposing them to Claude Code once connected.\n This streamlines setup and ensures your servers are consistently available across projects.\n\nBy focusing on clear tool design, real-time data, performance optimization, and secure integration, your MCP server becomes a powerful, reliable extension of Claudeâ€™s capabilities.\n\n\n","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-15T19:47:53.490694-06:00","updated_at":"2025-12-15T19:48:21.956334-06:00"}
{"id":"lr-pr4","title":"warn or auto-select embedding model based on index metadata","description":"When querying, if indexes were created with a different embedding model than the current query model, results will be garbage (0.000 similarity). The index stores EmbeddingModel in metadata - should either warn user or auto-select the right model for queries.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-15T22:54:53.679199-06:00","updated_at":"2025-12-15T23:40:53.649365-06:00","closed_at":"2025-12-15T23:40:53.649365-06:00","close_reason":"implemented: lr list now shows embedding model and compatibility indicator, infers model from dimensions for old indexes"}
{"id":"lr-pts","title":"handle edge case: get_diff_context when on main/master branch","description":"When user is on main branch, git diff main...HEAD returns empty. Options: auto-fallback to uncommitted, warn, or leave as-is","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-16T00:04:23.473154-06:00","updated_at":"2025-12-16T00:04:23.473154-06:00"}
{"id":"lr-wpn","title":"Code review context enhancement","description":"Local code review context feature using ollama embeddings.\n\n## Concept\n- Activatable feature for current working directory\n- Creates temporary index using ollama (local, free, fast)\n- Index is session-based - goes away when deactivated\n- Claude uses the index for code review context\n\n## Flow\n1. User runs `lr review start` in project dir\n2. lr indexes current project with ollama embeddings\n3. lr watch keeps index fresh on file changes\n4. MCP tool `get_diff_context` returns git diff + relevant indexed context\n5. Claude reviews with full codebase knowledge\n6. User runs `lr review stop` - index is deleted\n\n## Components\n- Ollama embedding support (local, no API)\n- Session-based index (temporary, per-project)\n- Watch mode (auto-update on file changes)\n- get_diff_context MCP tool (diff + context)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-15T21:40:16.467689-06:00","updated_at":"2025-12-15T22:02:24.842087-06:00","closed_at":"2025-12-15T22:02:24.842087-06:00","close_reason":"Closed","dependencies":[{"issue_id":"lr-wpn","depends_on_id":"lr-77n","type":"blocks","created_at":"2025-12-15T21:46:03.625869-06:00","created_by":"daemon"},{"issue_id":"lr-wpn","depends_on_id":"lr-lz8","type":"blocks","created_at":"2025-12-15T21:46:03.777458-06:00","created_by":"daemon"},{"issue_id":"lr-wpn","depends_on_id":"lr-y3h","type":"blocks","created_at":"2025-12-15T21:46:03.928097-06:00","created_by":"daemon"},{"issue_id":"lr-wpn","depends_on_id":"lr-1j7","type":"blocks","created_at":"2025-12-15T21:46:04.084391-06:00","created_by":"daemon"}]}
{"id":"lr-xoo","title":"FileCount not updated during watch mode","description":"","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-15T22:21:21.372129-06:00","updated_at":"2025-12-15T22:27:55.401113-06:00","closed_at":"2025-12-15T22:27:55.401113-06:00","close_reason":"fixed in code review cleanup"}
{"id":"lr-y3h","title":"Watch mode for review index","description":"Auto-update review index on file changes. Uses fsnotify or similar. Only active during review session.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T21:44:28.661458-06:00","updated_at":"2025-12-15T22:00:33.772992-06:00","closed_at":"2025-12-15T22:00:33.772992-06:00","close_reason":"Closed","dependencies":[{"issue_id":"lr-y3h","depends_on_id":"lr-lz8","type":"blocks","created_at":"2025-12-15T21:45:40.53462-06:00","created_by":"daemon"}]}
{"id":"lr-y95","title":"add multi-embedding support to indexes","description":"","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-15T23:26:38.603299-06:00","updated_at":"2025-12-15T23:40:45.532663-06:00","closed_at":"2025-12-15T23:40:45.532663-06:00","close_reason":"decided simpler approach: show embedding model in list with compatibility indicator"}
